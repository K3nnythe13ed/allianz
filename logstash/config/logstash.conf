input {
	beats {
		port => 5044
    codec => "json"
	}
}

filter{
  mutate {
    convert => { 
      "LONGITUDE" => "float" 
      "LATITUDE" => "float" 
    }
    rename => {
      "LONGITUDE" => "[LOCATION][lon]"
      "LATITUDE" => "[LOCATION][lat]"
    }
 }
    
  mutate {
    gsub => ["TIME", " GMT", ""]
  }

  date {
    match => ["TIME", "ISO8601", "yyyy-MM-dd HH:mm:ss"]
    timezone => 'UTC'
    remove_field => [ "TIME" ]
  }
}


output {
	elasticsearch {
		hosts => "elasticsearch:9200"
    index => "ais-%{+YYYY.MM.dd}"
    document_id => "%{[MMSI]}"
    document_type => "vessel"
    manage_template => false
	}
}

